<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="keywords" content="browsers harlem shake, harlem shake" />
<meta name="description" content="browsers harlem shake" />
<meta property="og:site_name" content="Browsers Harlem Shake" />
<meta property="og:type" content="web" />
<meta property="og:title" content="Browsers Harlem Shake" />
<meta property="og:image" content="http://rollroll.github.com/browsers-harlem-shake/assets/img/chrome.png" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width" />
<title>Browsers Harlem Shake</title>
<link href='http://fonts.googleapis.com/css?family=Yesteryear' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="assets/css/animate.css"/>
<link rel="stylesheet" type="text/css" href="assets/css/main.css"/>
</head>
<body>
<div id="wrap">
	<div id="container">
		<div id="caption">
			<h1 id="title" class="animated">Browsers Harlem Shake</h1>
			<img id="playBtn" src="assets/img/play.png" alt="Play !">
		</div>
		<ul id="browsers" class="browsers">
			<li><img id="safari" class="browserIcon animated" src="assets/img/safari.png" alt="Safari"></li>
			<li><img id="firefox" class="browserIcon animated" src="assets/img/firefox.png" alt="Firefox"></li>
			<li><img id="chrome" class="browserIcon animated" src="assets/img/chrome.png" alt="Google Chrome"></li>
			<li><img id="opera" class="browserIcon animated" src="assets/img/opera.png" alt="Opera"></li>
			<li id="iebox">
				<img id="question" src="assets/img/question.png" alt="Question">
				<img id="ie" class="browserIcon animated" src="assets/img/ie.png" alt="Internet Explorer">
			</li>
		</ul>
	</div>
</div>

<!-- <audio id="music" prelaod="auto">
	<source src="assets/audio/harlem_shake.ogg" type="audio/ogg">
	<source src="assets/audio/harlem_shake.mp3" type="audio/mpeg">
</audio> -->

<div id="footer">
<iframe src="http://www.facebook.com/plugins/like.php?href=http://rollroll.github.com/browsers-harlem-shake/" scrolling="no" frameborder="0" style="border:none; width:450px; height:80px"></iframe>
<a id="githubLink" href="https://github.com/rollRoll/browsers-harlem-shake">Fork on GitHub</a>
</div>

<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>
	var 
		isie10 = isIE10(),
		audio = new Audio(),		
		$playBtn = $('#playBtn'),
		$browsers = $('#browsers'),
		$question = $('#question'),
		shakeDoms = {
			title: $('#title'),
			chrome: $('#chrome'),
			firefox: $('#firefox'),
			safari: $('#safari'),
			opera: $('#opera')
		};

	( isie10 ) && ( shakeDoms.ie = $('#ie') );

	// load auido
	audio.src = 'assets/audio/harlem_shake' + ( isie10? '.mp3' : '.ogg' );
	audio.preload = "auto";
	audio.addEventListener('loadeddata', function() {
		$playBtn.on('click', play);
	}, false);
	audio.addEventListener('play', startShake, false);


	function play() {
		$playBtn.css('visibility', 'hidden');
		$browsers.removeClass('shake');
		$question.hide();
		resetObjects();
		audio.play();
	}

	function startShake() {
		// start
		setTimeout(function() {
			shakeDoms.chrome.addClass( 'animation-start' );
		}, 2000);

		// shake
		setTimeout(function() {
			$browsers.addClass('shake');
			shakeDoms.chrome.removeClass( 'animation-start' );
			shakeObjects();
		}, 15500);

		// stop
		setTimeout(function() {
			stopObjectsShake();
			$playBtn.css('visibility', 'visible');

			( ! isie10 ) && $question.show();
		}, 30000);

		_gaq.push(['_trackEvent', 'Start', 'Play', 'Start Harlem Shake']);
	}

	function shakeObjects() {
		$.each(shakeDoms, function(key, $dom) {
			$dom.addClass( 'animation-' + key );
		});
	}

	function stopObjectsShake() {
		$.each(shakeDoms, function(key, $dom) {
			$dom.addClass('animated-stop');
		});
	}

	function resetObjects() {
		$.each(shakeDoms, function(key, $dom) {
			$dom.removeClass( 'animated-stop animation-' + key );
		});
	}

	function isIE10() {
		var self = this.isIE10;
		self.version = ( self.version !== undefined )? self.version
			: /Mozilla\/5.0 \(compatible\; MSIE 10(.+)/.test( window.navigator.userAgent );
		return self.version;
	}

</script>
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-39043074-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_trackPageLoadTime']);

	(function() {
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
</body>
</html>
